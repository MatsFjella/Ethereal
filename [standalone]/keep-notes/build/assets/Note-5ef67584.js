import{m as O,d as q,h as $,w as D,r as N,p as R,o as V,a as T,b as I,g as M,s as C,n as L,f as Q,_ as U,c as E,e as j,i as w,j as A,k as W,l as B,q as z,t as H}from"./index-2d3c0272.js";const K=e=>O(q(e)),re=e=>O(e);let f=[],d=[];function k(e){d=d.filter(t=>t!==e)}function ie(e){k(e),d.push(e)}function ae(e){k(e),d.length===0&&f.length>0&&(f[f.length-1](),f=[])}function G(e){d.length===0?e():f.push(e)}function ue(e){f=f.filter(t=>t!==e)}function J(e,t){return e!==void 0&&e()||t}function se(e,t){if(e!==void 0){const r=e();if(r!=null)return r.slice()}return t}function ce(e,t){return e!==void 0?t.concat(e()):t}function le(e,t){return e===void 0?t:t!==void 0?t.concat(e()):e()}function fe(e,t,r,p,u,s){t.key=p+u;const i=$(e,t,r);return u===!0?D(i,s()):i}function de(e){if(Object(e.$parent)===e.$parent)return e.$parent;let{parent:t}=e.$;for(;Object(t)===t;){if(Object(t.proxy)===t.proxy)return t.proxy;t=t.parent}}function pe(e){return e.appContext.config.globalProperties.$router!==void 0}function X(e){return e.isUnmounted===!0||e.isDeactivated===!0}const Y=K({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:t,emit:r}){const p=M(),u=N(null);let s=0;const i=[];function m(o){const l=typeof o=="boolean"?o:e.noErrorFocus!==!0,v=++s,x=(n,a)=>{r("validation"+(n===!0?"Success":"Error"),a)},S=n=>{const a=n.validate();return typeof a.then=="function"?a.then(c=>({valid:c,comp:n}),c=>({valid:!1,comp:n,err:c})):Promise.resolve({valid:a,comp:n})};return(e.greedy===!0?Promise.all(i.map(S)).then(n=>n.filter(a=>a.valid!==!0)):i.reduce((n,a)=>n.then(()=>S(a).then(c=>{if(c.valid===!1)return Promise.reject(c)})),Promise.resolve()).catch(n=>[n])).then(n=>{if(n===void 0||n.length===0)return v===s&&x(!0),!0;if(v===s){const{comp:a,err:c}=n[0];if(c!==void 0&&console.error(c),x(!1,a),l===!0){const P=n.find(({comp:F})=>typeof F.focus=="function"&&X(F.$)===!1);P!==void 0&&P.comp.focus()}}return!1})}function g(){s++,i.forEach(o=>{typeof o.resetValidation=="function"&&o.resetValidation()})}function _(o){o!==void 0&&C(o);const l=s+1;m().then(v=>{l===s&&v===!0&&(e.onSubmit!==void 0?r("submit",o):o!==void 0&&o.target!==void 0&&typeof o.target.submit=="function"&&o.target.submit())})}function b(o){o!==void 0&&C(o),r("reset"),L(()=>{g(),e.autofocus===!0&&e.noResetFocus!==!0&&h()})}function h(){G(()=>{if(u.value===null)return;const o=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),l=>l.tabIndex>-1);o!=null&&o.focus({preventScroll:!0})})}R(Q,{bindComponent(o){i.push(o)},unbindComponent(o){const l=i.indexOf(o);l>-1&&i.splice(l,1)}});let y=!1;return V(()=>{y=!0}),T(()=>{y===!0&&e.autofocus===!0&&h()}),I(()=>{e.autofocus===!0&&h()}),Object.assign(p.proxy,{validate:m,resetValidation:g,submit:_,reset:b,focus:h,getValidationComponents:()=>i}),()=>$("form",{class:"q-form",ref:u,onSubmit:_,onReset:b},J(t.default))}}),Z={props:["note","options","type","paper_count"],data(){return{audio:null,count:0}},components:{TopBar:E(()=>j(()=>import("./TopBar-642dd2fb.js"),["./TopBar-642dd2fb.js","./QInput-5c77434c.js","./index-2d3c0272.js","./index-66b1d0a5.css","./QBtn-cf576227.js","./use-dark-60db826c.js","./TopBar-b4b66f31.css"],import.meta.url)),NotePaper:E(()=>j(()=>import("./NotePaper-82f44227.js"),["./NotePaper-82f44227.js","./index-2d3c0272.js","./index-66b1d0a5.css","./QBtn-cf576227.js","./NotePaper-520de98b.css"],import.meta.url))},mounted(){this.count=this.note.lines.length},watch:{note:{handler(){if(this.note.lines.length===this.count)return;const e=this.note.lines.length>this.count?"./sfx/drawing.mp3":"./sfx/pencil-eraser.mp3";e==="./sfx/drawing.mp3"&&this.count===this.note.lines.length||(this.count=this.note.lines.length,this.audio&&this.audio.pause(),this.audio=new Audio(e),this.audio.volume=.5,this.audio.play())},deep:!0}}};function ee(e,t,r,p,u,s){const i=B("TopBar"),m=B("NotePaper");return w(),A(Y,{onSubmit:this.$root.onSubmit},{default:W(()=>[this.$root.readonly?z("",!0):(w(),A(i,{key:0,paper_count:r.paper_count,note:r.note},null,8,["paper_count","note"])),H(m,{note:r.note,options:r.options},null,8,["note","options"])]),_:1},8,["onSubmit"])}const te=U(Z,[["render",ee]]),me=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{me as N,ce as a,G as b,K as c,re as d,le as e,X as f,de as g,J as h,ae as i,ie as j,se as k,fe as l,ue as r,pe as v};
